(function(e){function t(t){for(var r,s,i=t[0],l=t[1],c=t[2],d=0,p=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&p.push(n[s][0]),n[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==n[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},n={app:0},o=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"07d3":function(e,t,a){},"32c0":function(e,t,a){},"4ad3":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),n=a("69b4"),o=(a("f9e3"),a("2dd8"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[e._m(0),a("hr"),a("button",{directives:[{name:"v-b-toggle",rawName:"v-v-b-toggle.instructions",modifiers:{instructions:!0}}],staticClass:"btn btn-link"},[e._v("Instructions")]),a("b-collapse",{staticClass:"mt-1 mb-4",attrs:{id:"instructions",visible:e.show_instructions}},[a("b-card",[a("div",{staticClass:"card-text"},[a("b-tabs",{attrs:{card:""}},[a("b-tab",{attrs:{title:"General"}},[a("p",[e._v("\n                    If you have found this tool useful, please cite our paper,\n                    "),a("a",{attrs:{href:"https://doi.org/10.1093/bioinformatics/btab186",target:"_blank"}},[e._v("LocusZoom.js:\n                    interactive and embeddable visualization of genetic association study results")]),e._v(" (Bioinformatics 2021).\n                  ")]),a("p",[e._v("\n                    LocalZoom is a tool for generating region association plots via the web browser.\n                    It can be used on any Tabix-indexed file (including those stored on your hard drive), which\n                    makes it useful for sensitive or confidential data. If you are comfortable uploading\n                    your data to a server, consider the "),a("a",{attrs:{href:"https://my.locuszoom.org"}},[e._v("my.locuszoom.org")]),e._v(" upload service instead,\n                    which provides additional annotation features and does not require you to compress or index your data.\n                    (note that the upload service is limited to files <= 1GB)\n                    LocalZoom relies on four assumptions:\n                  ")]),a("ol",[a("li",[e._v("Your data is a text-based, tab-delimited file that has been stored in a compressed format,\n                    and "),a("a",{attrs:{href:"http://www.htslib.org/doc/tabix.html"}},[e._v("indexed using Tabix")]),e._v(". The\n                    index file must be in the same path, with the suffix "),a("em",[e._v(".tbi")])]),a("li",[e._v("The data is hosted in a place that is reachable by web browser (eg local files\n                    or a service such as S3)\n                    ")]),a("li",[e._v("If using a remote URL, the host location must support cross-origin byte range requests. ("),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests#Checking_if_a_server_supports_partial_requests"}},[e._v("how\n                      to check")]),e._v(") ("),a("a",{attrs:{href:"https://docs.cancergenomicscloud.org/docs/enabling-cross-origin-resource-sharing-cors#CORS"}},[e._v("how to configure cloud storage")]),e._v(")\n                    ")]),a("li",[e._v("Your file contains all of the information required to draw a plot (see individual file format instructions for details).")])]),a("p",[e._v("\n                    This service is designed to efficiently fetch only the data needed for the plot\n                    region of interest. Therefore, it cannot generate summary views that would require\n                    processing the entire file (eg Manhattan plots).\n                  ")]),a("p",[e._v("\n                    LD and overlay information is based on a specific human genome build ("),a("strong",[e._v("build GRCh37")]),e._v("\n                    or "),a("strong",[e._v("build GRCh38")]),e._v(" are supported). Exercise caution when interpreting\n                    plots based on a GWAS with positions from a different build.\n                  ")]),a("p",[e._v("\n                    Credible sets are\n                    "),a("a",{attrs:{href:"https://github.com/statgen/gwas-credible-sets/"}},[e._v("calculated")]),e._v(" based on the\n                    p-values for the displayed region. At the moment this tool does not support\n                    uploading your own custom credible set annotations.\n                  ")])]),a("b-tab",{attrs:{title:"GWAS"}},[a("h3",[e._v("What data is required?")]),a("p",[e._v("\n                    LocalZoom can read GWAS summary statistics from many file formats. When you add a\n                    study, we will attempt to automatically detect the columns for particular fields\n                    of interest, based on heuristic rules derived from several dozen common programs\n                    or file formats. The "),a("a",{attrs:{href:"https://my.locuszoom.org/about/#prepare-data"}},[e._v("required fields")]),e._v("\n                    are the same as for my.locuszoom.org, a related tool also developed at UMich.\n                    When you load a file, you will be asked to confirm the auto-determined options.\n                  ")]),a("h3",[e._v("How should I prepare my files?")]),a("p",[e._v("\n                    We attempt to support many GWAS file formats, and hence there is no single set of\n                    instructions for everyone. Below is a sample command that may be helpful; it is presented as several commands in\n                    a sequence, so that it can be run all at once as part of a data preparation workflow (like snakemake).\n                  ")]),a("p",[e._v("\n                    To support sorting and tabix indexing, your file will need to specify chromosome and position as separate fields, with tab delimiters.\n                    The example below assumes one header row, with chromosome as column 1 and position as column 2.\n                  ")]),a("dl",[a("dt",[e._v("Sort file, compress, and tabix-index results")]),a("dd",[e._v('\n                      Many programs already output summary statistics sorted by chromosome and position. If your tool does not, then you will need to sort the file before creating a tabix index (tabix is a tool that allows someone to query a file for all data in a contiguous genomic region).\n                      If your data is already sorted, then the "awk" step can be omitted, but you will still need to run '),a("i",[e._v("bgzip")]),e._v(" and "),a("i",[e._v("tabix")]),e._v('.\n                      Assuming that your chromosome is in column 1 and position in column 2, with one header row (skipped in both the awk "NR" command and the tabix --skip-lines flag):'),a("br"),a("code",[e._v("zcat < summstats.tab.gz | awk 'NR<=1{print $0;next}{print $0| \"sort -k1,1V -k2,2n\"}' | bgzip -c > summstats.sorted.tab.gz && tabix -s1 -b 2 -e 2 --skip-lines 1 -f summstats.sorted.tab.gz")]),a("br")]),a("dt",[e._v("(rarely needed) Converting to tab delimiters")]),a("dd",[e._v('\n                      Most modern GWAS programs output tab-delimited results (in each row, columns are separated via a tab character)- this makes it much easier to use popular generic indexing tools like tabix.\n                      Some old programs (such as PLINK 1.x) may generate files that use a different character\n                      ("space delimited" or "fixed width" formats), and append extra spaces to the start and end of a row.\n                      In the rare case where you need to accommodate such a program, the following command may be helpful to clean up the file format before use:'),a("br"),a("code",[e._v("cat filename.txt | sed 's/^[[:space:]]*//g' | sed 's/[[:space:]]*$//g' | tr -s ' ' '\\t' > > filename.tab")])])])]),a("b-tab",{attrs:{title:"BED files"}},[a("p",[e._v("\n                    BED files are a "),a("a",{attrs:{href:"https://genome.ucsc.edu/FAQ/FAQformat.html#format1"}},[e._v("standard format")]),e._v(" with 3-12 columns of data.\n                    The default LocusZoom panel layout for a BED track will use chromosome, position, line name, and (optionally) color\n                    to draw the plot. Score will be shown as a tooltip field (if present); it may have a different meaning and scale\n                    depending on the contents of your BED file. As with any LocusZoom track, custom layouts can be created to render data in different ways, or to use more or\n                    fewer columns based on the data of interest.\n                  ")]),a("p",[e._v("\n                    The following command is helpful for preparing BED files for use in the browser:"),a("br"),a("code",[e._v("$ sort -k1,1 -k2,2n input.bed | bgzip > input-sorted.bed.gz && tabix -p bed input-sorted.bed.gz")]),a("br"),e._v("\n                    Some BED files will have one or more header rows; in this case, modify the tabix command with: "),a("code",[e._v("--skip-lines N")]),e._v(" (where N is the number of headers).\n                  ")])]),a("b-tab",{attrs:{title:"PLINK 1.9 LD"}},[a("h3",[e._v("Before you begin")]),a("p",[e._v("\n                    Although PLINK is targeted as a (historically) popular tool for computing LD,\n                    the file format it generates must be transformed before using in a plot. Read these instructions carefully for help using the data with LocalZoom.\n                    We presently do not support arbitrary file formats, as this is an area of active innovation and there is no single clear standard.\n                    We welcome feedback on generally useful improvements; the current process is rather kludgy!\n                  ")]),a("h3",[e._v("Purpose")]),a("p",[e._v("\n                    Linkage Disequilibrium is an important tool for interpreting LocusZoom.js plots. In order to support viewing any\n                    region, most LocusZoom.js usages take advantage of the Michigan LD server to calculate region-based LD relative\n                    to a particular reference variant, based on the well-known 1000G reference panel.\n                  ")]),a("p",[e._v("\n                    We recognize that the 1000G reference panel (and its sub-populations) is not suited to all cases, especially for\n                    studies with ancestry-specific results or large numbers of rare variants not represented in a public panel.\n                    For many groups, "),a("a",{attrs:{href:"https://github.com/statgen/LDServer/"}},[e._v("setting up a private LD Server instance")]),e._v(" is not an option.\n                    As a fallback, we support parsing a file format derived from PLINK 1.9 `--ld-snp` calculations. Instructions\n                    for preparing these files are provided below. "),a("strong",[e._v("Due to the potential for very large output files, we only\n                    support pre-calculated LD relative to one (or a few) LD reference variants; this means that this feature\n                    requires some advance knowledge of interesting regions in order to be useful.")]),e._v(" If the user views any\n                    region that is not near a pre-provided reference variant, they will see grey dots indicating the absence of LD information.\n                    We have intentionally restricted the demo so that this limitation is clear.\n                  ")]),a("h3",[e._v("How to run PLINK and format output")]),a("dl",[a("dt",[a("b",[e._v("Preparing genotype files: harmonizing ID formats")])]),a("dd",[e._v("\n                      LocusZoom typically calculates LD relative to a variant by EPACTS-format specifier (chrom:pos_ref/alt).\n                      However, genotype VCF files have no single standard for how variants are identified, which can make it hard to match the requested variant to the actual data.\n                      Some files are not even internally consistent, which makes it hard to write easy copy-and-paste commands that would work widely\n                      across files. Your file can be transformed to match the tutorial assumptions via common tool and the command below:"),a("br"),a("code",[e._v("bcftools annotate -Oz --set-id '%CHROM\\:%POS\\_%REF\\/%ALT' original_vcf.gz > vcfname_epacts_id_format.gz")]),a("br"),a("em",[e._v("In some rare cases (such as "),a("a",{attrs:{href:"https://www.internationalgenome.org/faq/why-are-there-duplicate-calls-in-the-phase-3-call-set"}},[e._v("1000G phase 3")]),e._v("), data preparation errors may result in duplicate entries for the same variant. This can break PLINK. A command such as the one below can be used to find these duplicates:"),a("br"),a("code",[e._v("zcat < vcfname_epacts_id_format.gz | cut -f3 | sort | uniq -d")]),a("br"),e._v("\n                        They can then be removed using the following command (check the output carefully before using, because reasons for duplicate lines vary widely):\n                      ")]),a("br"),a("code",[e._v("bcftools norm -Oz --rm-dup all vcfname_epacts_id_format.gz > vcfname_epacts_id_format_rmdups.gz")])]),a("dt",[a("b",[e._v("Calculating LD relative to reference variants")])]),a("dd",[e._v("\n                      The command below will calculate LD relative to (several) variants in a 500 kb region centered around each reference variant."),a("br"),a("code",[e._v("plink-1.9 --r2 --vcf vcfname_epacts_id_format.gz --ld-window 499999 --ld-window-kb 500 --ld-window-r2 0.0 --ld-snp-list mysnplist.txt")]),a("br"),e._v("\n\n                      This command assumes the presence of a file named "),a("em",[e._v("mysnplist.txt")]),e._v(", which contains a series of rows like the example below:"),a("br"),a("pre",{staticStyle:{background:"#F4F4F4"}},[e._v("16:53842908_G/A\n16:53797908_C/G\n16:53809247_G/A")])]),a("dt",[a("b",[e._v("Preparing the LD output file for use with LocusZoom.js")])]),a("dd",[e._v('\n                      As of this writing, this tutorial assumes a "list of SNPs" feature that requires PLINK 1.9.x (and is not yet available in newer versions).\n                      Unfortunately, PLINK\'s default output format is not compatible with tabix, for historical reasons.\n                      Transform to a format readable by LocusZoom via the following sequence of commands.'),a("br"),a("code",[e._v("cat plink.ld | tail -n+2 | sed 's/^[[:space:]]*//g' | sed 's/[[:space:]]*$//g' | tr -s ' ' '\\t' | sort -k4,4 -k5,5n | bgzip > plink.ld.tab.gz && tabix -s4 -b5 -e5 plink.ld.tab.gz")])]),a("dt",[a("b",[e._v("I don't use PLINK; how should my file be formatted?")])]),a("dd",[e._v('\n                      A custom LD file should be tab-delimited. It should specify a reference variant ("SNP_A") and LD for all others relative to that variant ("SNP_B"). The first two rows will look like the following example, taken from actual PLINK output:\n                      '),a("pre",{staticStyle:{background:"#F4F4F4"}},[e._v("CHR_A\tBP_A\tSNP_A\tCHR_B\tBP_B\tSNP_B\tR2\n22\t37470224\t22:37470224_T/C\t22\t37370297\t22:37370297_T/C\t0.000178517")]),a("em",[e._v("Note: pre-calculated LD files can easily become very large. We recommend only outputting LD relative to a few target reference variants at a time.")])])])])],1)],1)])],1)],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("gwas-toolbar",{attrs:{genome_build:e.genome_build,max_studies:6,known_tracks:e.known_tracks},on:{"update:genome_build":function(t){e.genome_build=t},"add-tabix-track":e.receiveTrackOptions,"select-range":e.updateRegion}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("plot-panes",{ref:"plotWidget",attrs:{base_layout:e.base_layout,base_sources:e.base_sources,dynamic_urls:!0,genome_build:e.genome_build,known_tracks:e.known_tracks,chr:e.chr,start:e.start,end:e.end},on:{"plot-created":e.activateMetrics}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("footer",{staticStyle:{"text-align":"center"}},[e._v("\n          © Copyright "+e._s((new Date).getFullYear())+" "),a("a",{attrs:{href:"https://github.com/statgen"}},[e._v("The University of Michigan\n          Center for Statistical Genetics")]),a("br")])])])])}),s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h1",[a("strong",[e._v("LocalZoom: Plot your own data with LocusZoom.js")])])}],i=(a("6762"),a("2fdb"),a("9d18"),a("e2cc")),l=a("dbb6"),c=a("729c"),u=a("5bc8"),d=a("6039"),p=(a("2397"),a("20d6"),a("75fc")),_=a("768b"),f=(a("ac6a"),a("a481"),a("c5f6"),a("ee1d"),a("d225")),m=a("b0b4"),h=a("4e2b"),v=a("308d"),b=a("6bb5"),g=(a("0d6d"),a("4def")),y=a.n(g),w=a("ef2a"),x=a("1ccd"),C=a("01ef"),k=a("faf9"),S=a("3def"),P="https://portaldev.sph.umich.edu/api/v1/",O="https://portaldev.sph.umich.edu/ld/",L=/^(?:chr)?(\w+)\s*:\s*(\d+)$/,A=/^(?:chr)?(\w+)\s*:\s*(\d+)-(\d+)$/,j=5e5,z=Object.freeze({BED:"bed",GWAS:"gwas",PLINK_LD:"plink_ld"});function T(e){var t=E();return function(){var a,r=Object(b["a"])(e);if(t){var n=Object(b["a"])(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Object(v["a"])(this,a)}}function E(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}w["a"].use(x["a"]),w["a"].use(C["a"]),w["a"].use(k["a"]),w["a"].use(S["a"]);var D=Object.freeze({chr:"chrom",start:"start",end:"end",ldrefvar:"ld_variant"}),N=w["a"].Adapters.get("TabixUrlSource"),R=function(e){Object(h["a"])(a,e);var t=T(a);function a(){return Object(f["a"])(this,a),t.apply(this,arguments)}return Object(m["a"])(a,[{key:"_annotateRecords",value:function(e){return e.filter((function(e){return!Number.isNaN(e["log_pvalue"])}))}}]),a}(N);w["a"].Adapters.add("TabixAssociationLZ",R);var q=function(){var e=w["a"].Layouts.get("tooltip","standard_association_with_label");return e.html+='{{#if assoc:beta|is_numeric}}<br>&beta;: <strong>{{assoc:beta|scinotation|htmlescape}}</strong>{{/if}}\n{{#if assoc:stderr_beta|is_numeric}}<br>SE (&beta;): <strong>{{assoc:stderr_beta|scinotation|htmlescape}}</strong>{{/if}}\n{{#if assoc:alt_allele_freq|is_numeric}}<br>Alt. freq: <strong>{{assoc:alt_allele_freq|scinotation|htmlescape}} </strong>{{/if}}\n{{#if assoc:rsid}}<br>rsID: <a href="https://www.ncbi.nlm.nih.gov/snp/{{assoc:rsid|htmlescape}}" target="_blank" rel="noopener">{{assoc:rsid|htmlescape}}</a>{{/if}}\n{{#if credset:posterior_prob}}<br>Posterior probability: <strong>{{credset:posterior_prob|scinotation}}{{/if}}</strong><br>\n\n{{#if catalog:rsid}}<br><a href="https://www.ebi.ac.uk/gwas/search?query={{catalog:rsid}}" target="_new">See hits in GWAS catalog</a>{{/if}}',w["a"].Layouts.get("data_layer","association_pvalues",{namespace:{catalog:"catalog",credset:"credset"},data_operations:[{type:"fetch",from:["assoc","catalog","credset(assoc)","ld(credset)"]},{name:"assoc_credset_catalog",type:"assoc_to_gwas_catalog",requires:["credset","catalog"],params:["assoc:position","catalog:pos","catalog:log_pvalue"]},{name:"credset_plus_ld",type:"left_match",requires:["assoc_credset_catalog","ld"],params:["assoc:position","ld:position2"]}],tooltip:e,label:{text:"{{#if assoc:rsid}}{{assoc:rsid}}{{#else}}{{assoc:variant}}{{/if}}",spacing:12,lines:{style:{"stroke-width":"2px",stroke:"#333333","stroke-dasharray":"2px 2px"}},filters:[{field:"lz_show_label",operator:"=",value:!0}],style:{"font-weight":"bold"}}})}();w["a"].Layouts.add("data_layer","localzoom_assoc",q);var B=function(){var e=w["a"].Layouts.get("panel","association",{min_height:300,height:300,data_layers:[w["a"].Layouts.get("data_layer","significance"),w["a"].Layouts.get("data_layer","recomb_rate"),w["a"].Layouts.get("data_layer","localzoom_assoc")]});return e.toolbar.widgets.push({type:"display_options",custom_event_name:"widget_association_display_options_choice",position:"right",color:"blue",button_html:"Display options...",button_title:"Control how plot items are displayed",layer_name:"associationpvalues",default_config_display_name:"Default view",options:[{display_name:"95% credible set (boolean)",display:{point_shape:"circle",point_size:40,color:{field:"credset:is_member",scale_function:"if",parameters:{field_value:!0,then:"#00CC00",else:"#CCCCCC"}},legend:[{shape:"circle",color:"#00CC00",size:40,label:"In credible set",class:"lz-data_layer-scatter"},{shape:"circle",color:"#CCCCCC",size:40,label:"Not in credible set",class:"lz-data_layer-scatter"}]}},{display_name:"95% credible set (gradient by contribution)",display:{point_shape:"circle",point_size:40,color:[{field:"credset:contrib_fraction",scale_function:"if",parameters:{field_value:0,then:"#777777"}},{scale_function:"interpolate",field:"credset:contrib_fraction",parameters:{breaks:[0,1],values:["#fafe87","#9c0000"]}}],legend:[{shape:"circle",color:"#777777",size:40,label:"No contribution",class:"lz-data_layer-scatter"},{shape:"circle",color:"#fafe87",size:40,label:"Some contribution",class:"lz-data_layer-scatter"},{shape:"circle",color:"#9c0000",size:40,label:"Most contribution",class:"lz-data_layer-scatter"}]}},{display_name:"Label catalog traits",display:{label:{text:"{{catalog:trait}}",spacing:6,lines:{style:{"stroke-width":"2px",stroke:"#333333","stroke-dasharray":"2px 2px"}},filters:[{field:"catalog:trait",operator:"!=",value:null},{field:"catalog:log_pvalue",operator:">",value:7.301},{field:"ld:correlation",operator:">",value:.4}],style:{"font-size":"12px","font-weight":"bold",fill:"#333333"}}}}]}),w["a"].Layouts.renameField(e,"assoc:se","assoc:stderr_beta",!1),e}();function G(e){return e.replace(/[^A-Za-z0-9_]/g,"_")}function $(e,t){var a={assoc:"assoc_".concat(e),credset:"credset_".concat(e)};return[w["a"].Layouts.get("panel","localzoom_assoc",{id:"association_".concat(e),namespace:a,title:{text:t}}),w["a"].Layouts.get("panel","annotation_catalog",{id:"catalog_".concat(e),namespace:a,title:{text:"GWAS Catalog hits for ".concat(t),style:{"font-size":"150%"},x:50}})]}function I(e,t,a){var r="".concat(e,"_").concat(G(t));if(e===z.GWAS)return $(r,a);if(e===z.BED)return[w["a"].Layouts.get("panel","bed_intervals",{id:r,namespace:{intervals:r},title:{text:a}})];if(e===z.PLINK_LD)return[];throw new Error("Unrecognized datatype")}function W(e,t,a){var r="assoc_".concat(e);return[[r,["TabixAssociationLZ",{reader:t,parser_func:a}]],["credset_".concat(e),["CredibleSetLZ",{threshold:.95}]]]}function F(e,t,a,r){var n="".concat(e,"_").concat(G(a));if(e===z.GWAS)return W(n,t,r);if(e===z.BED)return[[n,["TabixUrlSource",{reader:t,parser_func:r}]]];if(e===z.PLINK_LD)return[["ld",["UserTabixLD",{reader:t,parser_func:r}]]];throw new Error("Unrecognized datatype")}function M(e,t,a,r){r.forEach((function(e){var a=Object(_["a"])(e,2),r=a[0],n=a[1];t.add(r,n,!0)})),a.forEach((function(t){t.y_index=-1,e.addPanel(t)}))}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(Object(p["a"])(e),[["recomb",["RecombLZ",{url:"".concat(P,"annotation/recomb/results/")}]],["catalog",["GwasCatalogLZ",{url:"".concat(P,"annotation/gwascatalog/results/")}]],["ld",["LDLZ2",{url:O,source:"1000G",population:"ALL"}]],["gene",["GeneLZ",{url:"".concat(P,"annotation/genes/")}]],["constraint",["GeneConstraintLZ",{url:"https://gnomad.broadinstitute.org/api/"}]]])}function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[].concat(Object(p["a"])(t),[w["a"].Layouts.get("panel","genes")]),n=Object.assign({state:e,panels:r},a);return w["a"].Layouts.get("plot","standard_association",n)}function V(e,t){var a=e.toolbar.widgets,r=a.findIndex((function(e){return"ld_population"===e.layout.tag}));if(-1!==r){var n=a[r];n.destroy(),a.splice(r,1),e.toolbar.update()}var o,s=a.findIndex((function(e){return"user_ld_description"===e.layout.tag}));if(-1!==s)o=a[s];else{var i={tag:"user_ld_description",type:"menu",color:"blue",position:"right",button_html:"USER LD",menu_html:""};e.layout.toolbar.widgets.push(i),o=e.toolbar.addWidget(i)}var l="This plot is being rendered with user-provided LD. The filename is: <b>".concat(y()(t),"</b>");w["a"].Layouts.mutate_attrs(e.layout,'$..widgets[?(@.tag === "user_ld_description")].menu_html',l),o.show(),e.mutateLayout(),e.toolbar.update(),e.applyState()}function K(e){window.gtag&&(e.on("widget_save_png",(function(){window.gtag("event","save_image",{event_category:"features",event_label:"png"})})),e.on("widget_save_svg",(function(){window.gtag("event","save_image",{event_category:"features",event_label:"svg"})})),e.on("widget_gene_filter_choice",(function(e){window.gtag("event","filter_genes",{event_category:"features",event_label:e.data.choice})})),e.on("widget_association_display_options_choice",(function(e){window.gtag("event","association_display_options",{event_category:"features",event_label:e.data.choice})})),e.on("widget_set_ldpop",(function(e){window.gtag("event","ld_pop",{event_category:"features",event_label:e.data.choice_value})})),e.on("set_ldrefvar",(function(e){window.gtag("event","ld_refvar",{event_category:"features"})})))}w["a"].Layouts.add("panel","localzoom_assoc",B);var H=function(e){var t=window.history[e];return function(){for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];var o=t.apply(this,r),s=new Event(e);return s.arguments=r,window.dispatchEvent(s),o}},Y=function(){window.gtag&&window.gtag("event","regionview")};window.gtag&&(window.history.pushState=H("pushState"),window.addEventListener("popstate",Y),window.addEventListener("pushState",Y));var J=function(e){window.gtag&&window.gtag("event","add_track",{event_category:"features",event_label:e})},Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{staticClass:"flex-nowrap",staticStyle:{"min-height":"1000px"},attrs:{pills:"",card:"",vertical:"","content-class":"scroll-extra"},model:{value:e.selected_tab,callback:function(t){e.selected_tab=t},expression:"selected_tab"}},[a("b-tab",{attrs:{active:e.selected_tab===e.TABS.PLOT,title:"GWAS"}},[e.has_studies?a("lz-plot",{ref:"assoc_plot",attrs:{show_loading:!0,base_layout:e.base_layout,base_sources:e.base_sources,chr:e.chr,start:e.start,end:e.end,dynamic_urls:e.dynamic_urls},on:{element_clicked:e.onVariantClick,connected:e.receivePlot}}):a("div",{staticClass:"placeholder-plot",staticStyle:{display:"table"}},[a("span",{staticClass:"text-center",staticStyle:{display:"table-cell","vertical-align":"middle"}},[e._v("\n            Please add data from a tabix file to continue\n          ")])])],1),a("b-tab",{attrs:{active:e.selected_tab===e.TABS.PHEWAS,disabled:!e.has_studies||!e.allow_phewas}},[a("template",{slot:"title"},[a("span",{attrs:{title:"Only available for build GRCh37 datasets"}},[e._v("PheWAS")])]),a("phewas-maker",{ref:"phewas",attrs:{variant_name:e.tmp_phewas_variant,genome_build:e.genome_build,your_study:e.tmp_phewas_study,your_logpvalue:e.tmp_phewas_logpvalue,allow_render:e.selected_tab===e.TABS.PHEWAS}})],2),a("b-tab",{attrs:{active:e.selected_tab===e.TABS.EXPORT,disabled:!e.has_studies,title:"Export"}},[a("export-data",{attrs:{known_tracks:e.known_tracks,table_data:e.table_data},on:{"requested-data":e.subscribeToData}})],1)],1)],1)],1)},X=[],ee=(a("28a5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("label",[e._v("Select a study:\n        "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_study,expression:"selected_study"}],staticStyle:{width:"20em"},attrs:{disabled:0===e.gwas_tracks.length},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selected_study=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v("(none selected)")]),e._l(e.gwas_tracks,(function(t){var r=t.filename,n=t.display_name;return a("option",{key:r,domProps:{value:r}},[e._v("\n            "+e._s(n===r?n:n+" ({"+r+")")+"\n          ")])}))],2)])])]),e.selected_study?e._e():a("p",[e._m(0)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("button",{staticClass:"btn btn-info float-right",attrs:{disabled:!e.selected_study},on:{click:e.exportCSV}},[e._v("Download")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("tabulator-table",{attrs:{columns:e.table_config,"initial-sort":[{column:"assoc:log_pvalue",dir:"desc"}],table_data:e.table_data,height:"500px",placeholder:"No data available for selected study in the specified region"},on:{connected:function(t){e.table=t}}})],1)])])}),te=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticStyle:{color:"red"}},[a("i",[e._v('Please select a GWAS dataset to use the "export" feature.')])])}],ae=(a("7514"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{ref:"table"},[e._t("default")],2)])}),re=[],ne=a("e325"),oe=(a("c624"),{name:"TabulatorTable",props:{table_data:{type:Array,default:function(){return[]}},placeholder:{type:String,default:null},columns:{type:Array,default:function(){return[]}},initialSort:{type:Array,default:function(){return[]}},layout:{type:String,default:"fitData"},layoutColumnsOnNewData:{type:Boolean,default:!0},height:{type:String,default:"100%"}},watch:{table_data:{handler:function(e){this.tabulator.setData(e)},deep:!0},columns:{handler:function(e){this.tabulator.setColumns(e),this.tabulator.setSort(e)},deep:!0}},beforeCreate:function(){this.tabulator=null},mounted:function(){var e=this.table_data,t=this.columns,a=this.initialSort,r=this.layout,n=this.layoutColumnsOnNewData,o=this.height,s=this.placeholder;this.tabulator=new ne["a"](this.$refs.table,{data:e,columns:t,initialSort:a,layout:r,layoutColumnsOnNewData:n,height:o,placeholder:s}),this.$emit("connected",this.tabulator)}}),se=oe,ie=a("2877"),le=Object(ie["a"])(se,ae,re,!1,null,null,null),ce=le.exports;function ue(e,t){var a=e.getValue();return"number"!==typeof a?null:w["a"].TransformationFunctions.get("scinotation")(a)}var de={name:"ExportData",components:{TabulatorTable:ce},props:{known_tracks:{type:Array,default:function(){return[]}},table_data:{type:Array,default:function(){return[]}}},data:function(){return{selected_study:"",export_type:"top_hits"}},computed:{source_name:function(){return"gwas_".concat(G(this.selected_study||""))},gwas_tracks:function(){return this.known_tracks.filter((function(e){var t=e.data_type;return t===z.GWAS}))},table_config:function(){var e=[{title:"Chrom",field:"assoc:chromosome"},{title:"Pos",field:"assoc:position",sorter:"number"},{title:"Ref",field:"assoc:ref_allele"},{title:"Alt",field:"assoc:alt_allele"},{title:"rsID",field:"assoc:rsid"},{title:"-log<sub>10</sub>(p)",field:"assoc:log_pvalue",formatter:ue,sorter:"number"},{title:"&beta;",field:"assoc:beta",formatter:"money",formatterParams:{precision:3},sorter:"number"},{title:"SE(&beta;)",field:"assoc:stderr_beta",formatter:"money",formatterParams:{precision:3},sorter:"number"},{title:"Alt freq.",field:"assoc:alt_allele_freq",formatter:"money",formatterParams:{precision:3},sorter:"number"},{title:"Cred. set",field:"credset:is_member",formatter:"tickCross"},{title:"Posterior probability",field:"credset:posterior_prob",formatter:ue}];return e}},watch:{source_name:function(){var e=this,t=this.source_name;this.gwas_tracks.find((function(t){var a=t.filename;return a===e.selected_study}))?this.$emit("requested-data","association_".concat(t,".associationpvalues")):this.$emit("requested-data")}},beforeCreate:function(){this.table=null},methods:{exportCSV:function(){this.table.download("csv","results_".concat(this.source_name,".csv"))}}},pe=de,_e=Object(ie["a"])(pe,ee,te,!1,null,"74bd6a44",null),fe=_e.exports,me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"lz-container-responsive",attrs:{id:e.dom_id}},[e._t("default")],2)])},he=[],ve=(a("456d"),a("3e6c")),be=0,ge={name:"LzPlot",props:{base_layout:{type:Object,default:function(){return{}}},base_sources:{type:Array,default:function(){return[]}},chr:{type:String,default:null},start:{type:Number,default:null},end:{type:Number,default:null},show_loading:{type:Boolean,default:!1},dynamic_urls:{type:Boolean,default:!1}},computed:{region:function(){var e=this.chr,t=this.start,a=this.end;return{chr:e,start:t,end:a}}},watch:{region:{handler:function(){var e=this,t=Object.assign({},this.region),a=Object.keys(t).reduce((function(a,r){var n=t[r];return n!==e.plot.state[r]&&(a[r]=n),a}),{});Object.keys(a).length&&this.plot.applyState(a)},deep:!0}},beforeCreate:function(){be+=1,this.dom_id="lz-plot-".concat(be),this.plot_id=this.dom_id.replace(/-/g,"_"),this.plot=null,this.data_sources=null},mounted:function(){this.createLZ(this.base_layout,this.base_sources)},beforeDestroy:function(){this.plot.destroy(),delete this.plot,delete window[this.plot_id]},methods:{createLZ:function(e,t){var a=JSON.parse(JSON.stringify(e)),r=new w["a"].DataSources;t.forEach((function(e){var t=Object(_["a"])(e,2),a=t[0],n=t[1];return r.add(a,n)}));var n=w["a"].populate("#".concat(this.dom_id),r,a);this.show_loading&&n.layout.panels.forEach((function(e){return n.panels[e.id].addBasicLoader()})),this.plot=n,this.data_sources=r,window[this.plot_id]=n,this.connectListeners(n),this.$emit("connected")},connectListeners:function(e){var t=this;e.on("any_lz_event",(function(e){return t.$emit(e.event_name,e)})),this.dynamic_urls&&(Object(ve["a"])(e,D),Object(ve["b"])(e,D))},callPlot:function(e){return e(this.plot)},callSources:function(e){return e(this.data_sources)},addPanels:function(e,t){M(this.plot,this.data_sources,e,t)}}},ye=ge,we=Object(ie["a"])(ye,me,he,!1,null,null,null),xe=we.exports,Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.variant_name&&e.rendered?a("div",[a("h3",[e._v("Known PheWAS Results: "+e._s(e.variant_name))]),a("p",[e._v("\n      In your study "),a("em",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.your_study))]),e._v(", this variant has a\n      "),a("span",{staticClass:"text-muted definition",attrs:{title:"p-value "+e.display_pvalue}},[e._v("\n        -log"),a("sub",[e._v("10")]),e._v(" p-value of "),a("strong",[e._v(e._s(e.display_logpvalue))])]),e._v(". Below are other\n      results for comparison.\n    ")]),a("lz-plot",{ref:"phewas_plot",attrs:{base_layout:e.base_phewas_layout,base_sources:e.base_phewas_sources,show_loading:!0},on:{connected:e.receivePlot}})],1):a("p",[e._v("\n    Please select a variant in order to generate a PheWAS plot. You can click on any scatter plot\n    point in an association track.\n  ")]),e._m(0)])},ke=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("\n    PheWAS results are drawn from a large-scale analysis of the UK Biobank dataset, as described in\n    "),a("a",{attrs:{href:"https://doi.org/10.1038/s41588-018-0184-y"}},[e._v("Nature Genetics volume 50, pages 1335–1341 (2018)")]),e._v(".\n  ")])}],Se=(a("fca0"),{name:"PhewasMaker",components:{LzPlot:xe},props:{variant_name:{type:String,default:""},genome_build:{type:String,default:"GRCh37"},your_study:{type:String,default:""},your_logpvalue:{type:Number,default:null},allow_render:{type:Boolean,default:!0}},data:function(){return{rendered:this.allow_render}},computed:{display_logpvalue:function(){return w["a"].TransformationFunctions.get("scinotation")(this.your_logpvalue)},display_pvalue:function(){var e=this.your_logpvalue;return Number.isFinite(e)?w["a"].TransformationFunctions.get("scinotation")(Math.pow(10,-e)):0},base_phewas_layout:function(){var e=w["a"].Layouts.get("data_layer","phewas_pvalues",{y_axis:{min_extent:[0,10]}}),t=w["a"].Layouts.get("panel","phewas",{height:300,min_height:300,data_layers:[e]});return w["a"].Layouts.get("plot","standard_phewas",{panels:[t],responsive_resize:!0,state:{variant:this.variant_name,genome_build:this.genome_build}})},base_phewas_sources:function(){return[["phewas",["PheWASLZ",{url:"https://portaldev.sph.umich.edu/ukbb/v1/statistic/phewas/"}]]]},render_trigger:function(){return this.allow_render,this.variant_name}},watch:{allow_render:function(e){var t=this.variant_name;e&&t&&(this.rendered=!0),this.has_plot&&t&&(this.$refs.phewas_plot.callPlot((function(e){return e.curtain.hide()})),this.$refs.phewas_plot.callPlot((function(e){return e.applyState({variant:t})})))}},beforeCreate:function(){this.has_plot=!1},methods:{callPlot:function(e){this.has_plot&&this.$refs.phewas_plot.callPlot(e)},receivePlot:function(){this.has_plot=!0,this.$refs.phewas_plot.callPlot((function(e){e.subscribeToData({from_layer:"phewas.phewaspvalues"},(function(e,t){e&&e.length||t.curtain.show("There is no PheWAS data available for the requested variant. Please try another variant.")}))})),this.$refs.phewas_plot.callPlot((function(e){return e.emit("data_rendered")}))}}}),Pe=Se,Oe=(a("eae3"),Object(ie["a"])(Pe,Ce,ke,!1,null,"0bee02fc",null)),Le=Oe.exports,Ae=Object.freeze({PLOT:0,PHEWAS:1,EXPORT:2}),je={name:"PlotPanes",components:{ExportData:fe,LzPlot:xe,PhewasMaker:Le,BCard:l["a"],BTab:c["a"],BTabs:u["a"]},props:{base_layout:{type:Object,default:function(){return{}}},base_sources:{type:Array,default:function(){return[]}},known_tracks:{type:Array,default:function(){return[]}},chr:{type:String,default:null},start:{type:Number,default:null},end:{type:Number,default:null},genome_build:{type:String,default:"GRCh37"},dynamic_urls:{type:Boolean,default:!1}},data:function(){return{selected_tab:0,tmp_phewas_study:null,tmp_phewas_variant:null,tmp_phewas_logpvalue:null,tmp_export_callback:null,table_data:[]}},computed:{allow_phewas:function(){return"GRCh37"===this.genome_build},has_studies:function(){return!!this.known_tracks.length}},beforeCreate:function(){this.TABS=Ae,this.has_plot=!1},methods:{receivePlot:function(){this.has_plot=!0,this.$emit("plot-created")},addStudy:function(e,t){this.$refs.assoc_plot.addPanels(e,t)},onVariantClick:function(e){var t=e.sourceID;if(-1!==t.indexOf("association_")){var a=e.data;this.tmp_phewas_study=t.split(".")[1].replace(/^association_/,""),this.tmp_phewas_variant=a["assoc:variant"],this.tmp_phewas_logpvalue=a["assoc:log_pvalue"]}},subscribeToData:function(e){var t=this;this.tmp_export_callback&&(this.$refs.assoc_plot.callPlot((function(e){return e.off("data_from_layer",t.tmp_export_callback)})),this.tmp_export_callback=null),e&&this.has_plot?(this.tmp_export_callback=this.$refs.assoc_plot.callPlot((function(a){return a.subscribeToData({from_layer:e},(function(e){return t.table_data=e}))})),this.$refs.assoc_plot.callPlot((function(e){return e.applyState()}))):this.table_data=[]}}},ze=je,Te=(a("a8b7"),Object(ie["a"])(ze,Q,X,!1,null,null,null)),Ee=Te.exports,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[e.batch_mode_active?e._e():a("div",{staticClass:"col-sm-6"},[e.study_count<e.max_studies?a("div",[a("tabix-adder",{attrs:{allow_ld:e.study_count>0},on:{ready:e.receiveTabixReader,fail:e.showMessage}})],1):e._e()]),e.batch_mode_active?e._e():a("div",{staticClass:"col-sm-6"},[e.study_count?a("div",{staticClass:"d-flex justify-content-end"},[a("region-picker",{attrs:{genome_build:e.genome_build,max_range:e.max_region_size,search_url:"https://portaldev.sph.umich.edu/api/v1/annotation/omnisearch/"},on:{ready:e.selectRange,fail:e.showMessage}}),a("batch-spec",{staticClass:"ml-1",attrs:{max_range:e.max_region_size},on:{ready:e.activateBatchMode},scopedSlots:e._u([e.batch_region_getter?{key:"preset-button",fn:function(t){var r=t.updateRegions;return[a("button",{staticClass:"btn btn-warning",on:{click:function(t){r(e.batch_region_getter())}}},[e._v("Get top hits")])]}}:null],null,!0)})],1):a("b-dropdown",{staticClass:"float-right",attrs:{text:"Genome Build",variant:"info"}},[a("div",{staticClass:"px-3"},[a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.i_genome_build,expression:"i_genome_build"}],staticClass:"form-check-input",attrs:{id:"build-37",type:"radio",name:"genome_build",value:"GRCh37"},domProps:{checked:e._q(e.i_genome_build,"GRCh37")},on:{change:function(t){e.i_genome_build="GRCh37"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"build-37"}},[e._v("GRCh37")])]),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.i_genome_build,expression:"i_genome_build"}],staticClass:"form-check-input",attrs:{id:"build-38",type:"radio",name:"genome_build",value:"GRCh38"},domProps:{checked:e._q(e.i_genome_build,"GRCh38")},on:{change:function(t){e.i_genome_build="GRCh38"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"build-38"}},[e._v("GRCh38")])])])])],1),e.batch_mode_active?a("div",{staticClass:"col-md-12"},[a("batch-scroller",{attrs:{regions:e.batch_mode_regions},on:{navigate:e.selectRange,cancel:function(t){e.batch_mode_active=!1}}})],1):e._e(),e.message?a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("span",{class:[e.message_class]},[e._v(e._s(e.message))])])]):e._e()])])},Ne=[],Re=(a("8e6e"),a("bd86")),qe=a("eb59"),Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-dropdown",{ref:"dropdown",attrs:{variant:"info",right:"",text:"Batch view"}},[a("div",{staticClass:"px-3"},[a("label",{attrs:{for:"batch-region-list"}},[e._v("Specify regions to plot (one per line):")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.region_text,expression:"region_text"}],attrs:{id:"batch-region-list",rows:"10",placeholder:"chr:start-end or chr:pos"},domProps:{value:e.region_text},on:{input:function(t){t.target.composing||(e.region_text=t.target.value)}}}),e.message?a("div",{staticClass:"text-danger"},[e._v(e._s(e.message))]):e._e(),a("div",{staticClass:"d-flex justify-content-end align-items-center"},[e.show_loader?a("div",{staticClass:"d-flex align-items-center spinner-border   text-secondary mr-1",attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[e._v("Loading...")])]):e._e(),e._t("preset-button",null,{updateRegions:e.updateRegions}),a("button",{staticClass:"btn btn-success ml-1",on:{click:e.sendRegions}},[e._v("Go")])],2)])])],1)},Ge=[];a("6b54"),a("4917");function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.region_size,r=void 0===a?j:a,n=Math.floor(r/2);return[Math.max(e-n,1),e+n]}function Ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.region_size,r=void 0===a?j:a,n=t.padding,o=void 0===n?.025:n,s=Math.max(1,e-r*o),i=s+r*(1+o);return[s,i]}function We(e,t){var a,r,n,o=t.region_size,s=void 0===o?j:o,i=e.match(A),l=e.match(L);if(i){var c=i.slice(1),u=Object(_["a"])(c,3);a=u[0],r=u[1],n=u[2],r=+r,n=+n}else{if(!l)throw new Error("Could not parse the specified range: ".concat(e));var d,p=l.slice(1),f=Object(_["a"])(p,2);a=f[0],d=f[1],d=+d;var m=$e(d,{region_size:s}),h=Object(_["a"])(m,2);r=h[0],n=h[1]}if(s&&n-r>s)throw new Error("Maximum allowable range is ".concat(s.toLocaleString()," bp"));if(n<r)throw new Error("The requested end position ".concat(n.toLocaleString()," is smaller than the requested start position ").concat(r.toLocaleString()));return{chr:a,start:r,end:n}}var Fe={name:"BatchSpec",components:{BDropdown:qe["a"]},props:{max_range:{type:Number,default:null}},data:function(){return{region_text:"",show_loader:!1,message:null}},methods:{getRegionsFromTextBox:function(){var e=this,t=this.region_text.trim().split(/\r?\n/).filter((function(e){return!!e}));return t.map((function(t){return We(t,{region_size:e.max_range})}))},validateRegions:function(e){return!!e.length},updateRegions:function(e){var t=this;this.show_loader=!0,Promise.resolve(e).then((function(e){return e.map((function(e){var t=e.chr,a=e.start,r=e.end;return"".concat(t,":").concat(a,"-").concat(r)})).join("\n")})).then((function(e){t.region_text=e})).catch((function(e){t.message="Unable to retrieve items"})).finally((function(){t.show_loader=!1}))},sendRegions:function(){var e;try{e=this.getRegionsFromTextBox()}catch(t){return void(this.message=t.toString())}e.length?(this.message="",this.$emit("ready",e),this.$refs.dropdown.hide()):this.message="Must specify at least one region"}}},Me=Fe,Ze=Object(ie["a"])(Me,Be,Ge,!1,null,"001c3278",null),Ue=Ze.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"alert-success d-flex justify-content-between align-items-center"},[a("button",{staticClass:"btn btn-link",attrs:{disabled:e.current_index<=0},on:{click:function(t){return e.goToItem(-1)}}},[e._v("< Prev")]),a("span",[e._v("\n    Current Locus: "+e._s(e.current_region_display)+" -\n    "),null!==e.current_index?a("span",[e._v("\n      ("+e._s(e.current_index+1)+" of "+e._s(e.regions.length)+") -\n    ")]):e._e(),a("button",{staticClass:"btn btn-link p-0 border-0 align-bottom",attrs:{title:"Cancel navigation"},on:{click:e.cancelNavigation}},[e._v("cancel batch mode")])]),a("button",{staticClass:"btn btn-link",attrs:{disabled:null!==e.current_index&&e.current_index>=e.regions.length-1},on:{click:function(t){return e.goToItem(1)}}},[e._v("Next >")])])},Ke=[],He={name:"BatchScroller",props:{regions:{type:Array,default:function(){return[]}}},data:function(){return{current_index:null}},computed:{current_region:function(){return null===this.current_index?null:this.regions[this.current_index]},current_region_display:function(){var e=this.current_region;if(!e)return"(none)";var t=e.chr,a=e.start,r=e.end;return"".concat(t,": ").concat(a.toLocaleString(),"-").concat(r.toLocaleString())}},methods:{cancelNavigation:function(){this.$emit("cancel")},goToItem:function(e){null===this.current_index?this.current_index=0:this.current_index+=e,this.$emit("navigate",this.current_region)}}},Ye=He,Je=Object(ie["a"])(Ye,Ve,Ke,!1,null,"bc1573d0",null),Qe=Je.exports,Xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container"},[a("div",{staticClass:"modal-header"},[a("h3",[e._v("Select file options...")]),a("button",{staticClass:"pull-right",attrs:{"aria-label":"close"},on:{click:function(t){return e.$emit("close")}}},[e._v("X\n          ")])]),a("div",{staticClass:"modal-body"},[a("div",[e.current_page===e.PAGES.variant?a("div",[a("b-tabs",{model:{value:e.variant_spec_tab,callback:function(t){e.variant_spec_tab=t},expression:"variant_spec_tab"}},[a("b-tab",{staticClass:"pt-3",attrs:{title:"Variant from columns"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-chr-"+e._uid}},[e._v("Chromosome")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.chrom_col,expression:"chrom_col"}],staticClass:"form-control",attrs:{id:"vs-chr-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.chrom_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pos-"+e._uid}},[e._v("Position")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pos_col,expression:"pos_col"}],staticClass:"form-control",attrs:{id:"vs-pos-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.pos_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-ref-"+e._uid}},[e._v("Ref allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.ref_col,expression:"ref_col"}],staticClass:"form-control",attrs:{id:"vs-ref-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.ref_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-alt-"+e._uid}},[e._v("Alt allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.alt_col,expression:"alt_col"}],staticClass:"form-control",attrs:{id:"vs-alt-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.alt_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])])]),a("b-tab",{staticClass:"pt-3",attrs:{title:"Variant from marker"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-marker-"+e._uid}},[e._v("Marker")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.marker_col,expression:"marker_col"}],staticClass:"form-control",attrs:{id:"vs-marker-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.marker_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])])])],1),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pval-"+e._uid}},[e._v("P-value column")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pvalue_col,expression:"pvalue_col"}],staticClass:"form-control",attrs:{id:"vs-pval-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.pvalue_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)]),a("div",{staticClass:"col-sm-2"},[a("label",{staticClass:"form-check-label",staticStyle:{"white-space":"nowrap"},attrs:{for:"is_neg_log_pvalue"}},[e._v("\n                    is "),a("em",[e._v("-log"),a("sub",[e._v("10")]),e._v("(p)")])])]),a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-check float-left"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.is_neg_log_pvalue,expression:"is_neg_log_pvalue"}],staticClass:"form-check-input",attrs:{id:"is_neg_log_pvalue",type:"checkbox"},domProps:{checked:Array.isArray(e.is_neg_log_pvalue)?e._i(e.is_neg_log_pvalue,null)>-1:e.is_neg_log_pvalue},on:{change:function(t){var a=e.is_neg_log_pvalue,r=t.target,n=!!r.checked;if(Array.isArray(a)){var o=null,s=e._i(a,o);r.checked?s<0&&(e.is_neg_log_pvalue=a.concat([o])):s>-1&&(e.is_neg_log_pvalue=a.slice(0,s).concat(a.slice(s+1)))}else e.is_neg_log_pvalue=n}}})])])])],1):e.current_page===e.PAGES.optional?a("div",[a("h3",[e._v("Optional fields")]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-beta-"+e._uid}},[e._v("Effect size")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.beta_col,expression:"beta_col"}],staticClass:"form-control",attrs:{id:"vs-beta-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.beta_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)]),a("div",{staticClass:"col-sm-6"})]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-stderr-"+e._uid}},[e._v("Std. Err.")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.stderr_beta_col,expression:"stderr_beta_col"}],staticClass:"form-control",attrs:{id:"vs-stderr-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.stderr_beta_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)])]),a("h4",[e._v("Allele Frequency")]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2"},[e._v("Effect allele")]),a("div",{staticClass:"col-sm-10"},[a("b-form-radio",{attrs:{value:!1,inline:""},model:{value:e.is_alt_effect,callback:function(t){e.is_alt_effect=t},expression:"is_alt_effect"}},[e._v("Ref")]),a("b-form-radio",{attrs:{value:!0,inline:""},model:{value:e.is_alt_effect,callback:function(t){e.is_alt_effect=t},expression:"is_alt_effect"}},[e._v("Alt")])],1)]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2"},[e._v("Specify from")]),a("div",{staticClass:"col-sm-10"},[a("b-form-radio",{attrs:{value:e.AF_SPEC.freq,inline:""},model:{value:e.freq_spec_option,callback:function(t){e.freq_spec_option=t},expression:"freq_spec_option"}},[e._v("Frequency")]),a("b-form-radio",{attrs:{value:e.AF_SPEC.count,inline:""},model:{value:e.freq_spec_option,callback:function(t){e.freq_spec_option=t},expression:"freq_spec_option"}},[e._v("Counts")])],1)]),e.freq_spec_option===e.AF_SPEC.freq?a("div",[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-af-freq-"+e._uid}},[e._v("Frequency")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.allele_freq_col,expression:"allele_freq_col"}],staticClass:"form-control",attrs:{id:"vs-af-freq-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.allele_freq_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                        "+e._s(t)+"\n                      ")])})),0)]),a("div",{staticClass:"col-sm-6"})])]):e.freq_spec_option===e.AF_SPEC.count?a("div",[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-af-count-"+e._uid}},[e._v("Count")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.allele_count_col,expression:"allele_count_col"}],staticClass:"form-control",attrs:{id:"vs-af-count-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.allele_count_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                        "+e._s(t)+"\n                      ")])})),0)]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-af-ns-"+e._uid}},[e._v("# Samples")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.n_samples_col,expression:"n_samples_col"}],staticClass:"form-control",attrs:{id:"vs-af-ns-"+e._uid},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.n_samples_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,r){return a("option",{key:r,domProps:{value:r+1}},[e._v("\n                        "+e._s(t)+"\n                      ")])})),0)])])]):a("div",[a("span",{staticClass:"text-muted"},[e._v("\n                  Please select a frequency option in order to use this feature\n                ")])])]):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"card card-body bg-light"},[e.isValid&&e.preview.error?a("div",[a("span",{staticClass:"text-danger"},[e._v(e._s(e.preview.error))])]):e.isValid?a("div",[a("table",{staticClass:"preview-table"},[a("tr",[a("td",[e._v("Variant")]),a("td",[e._v(e._s(e.preview.variant))])]),a("tr",[a("td",[e._v("-log"),a("sub",[e._v("10")]),e._v("(p)")]),a("td",[e._v(e._s(e.preview.log_pvalue.toFixed(3)))])]),a("tr",[a("td",[e._v("β")]),a("td",[e._v(e._s(e.preview.beta?e.preview.beta.toFixed(3):""))])]),a("tr",[a("td",[e._v("SE(β)")]),a("td",[e._v(e._s(e.preview.stderr_beta?e.preview.stderr_beta.toFixed(3):""))])]),a("tr",[a("td",[e._v("Allele freq")]),a("td",[e._v("\n                        "+e._s(e.preview.alt_allele_freq?e.preview.alt_allele_freq.toFixed(3):"")+"\n                      ")])])])]):a("div",[e._v("\n                  Please select options to preview parsed data.\n                ")])])]),a("div",{staticClass:"row mt-3"},[e.current_page===e.PAGES.optional?a("button",{staticClass:"btn btn-success ml-auto",attrs:{disabled:!e.isValid},on:{click:e.sendOptions}},[e._v("\n                Accept options\n              ")]):a("button",{staticClass:"btn btn-success ml-auto",attrs:{disabled:!e.isValid},on:{click:function(t){e.current_page+=1}}},[e._v("Next\n              ")])])])])])])])])},et=[],tt=a("8807"),at=a("901d"),rt=a("d917"),nt=a("051d"),ot=a("391b"),st=0,it=1,lt={freq:1,count:2},ct={variant:1,optional:2},ut=0,dt={name:"GwasParserOptions",components:{BFormGroup:tt["a"],BFormRadio:at["a"],BTab:c["a"],BTabs:u["a"]},props:{file_reader:{type:Object,default:null}},data:function(){return{column_titles:[],sample_data:[],current_page:ct.variant,variant_spec_tab:st,freq_spec_option:null,marker_col:null,chrom_col:this.file_reader.colSeq||null,pos_col:this.file_reader.colStart||null,ref_col:null,alt_col:null,pvalue_col:null,is_neg_log_pvalue:!1,beta_col:null,stderr_beta_col:null,allele_freq_col:null,allele_count_col:null,n_samples_col:null,is_alt_effect:null}},computed:{freqSpec:function(){var e=this.freq_spec_option,t=this.allele_freq_col,a=this.allele_count_col,r=this.n_samples_col,n=this.is_alt_effect,o={is_alt_effect:n},s=null!==n;return e===lt.freq?(s=s&&Object(ot["c"])(t),o.allele_freq_col=t):e===lt.count&&(s=s&&Object(ot["c"])(a)&&Object(ot["c"])(r),o.allele_count_col=a,o.n_samples_col=r),s?o:{}},variantSpec:function(){var e=this.marker_col,t=this.chrom_col,a=this.pos_col,r=this.ref_col,n=this.alt_col;if(this.variant_spec_tab===it&&Object(ot["c"])(e))return{marker_col:e};if(this.variant_spec_tab===st&&Object(ot["c"])(a)&&Object(ot["c"])(t)){var o={chrom_col:t,pos_col:a};return Object(ot["c"])(r)&&Object(ot["c"])(n)&&Object.assign(o,{ref_col:r,alt_col:n}),o}return{}},parserOptions:function(){var e=this.pvalue_col,t=this.is_neg_log_pvalue,a=this.beta_col,r=this.stderr_beta_col;return Object.assign({},{pvalue_col:e,is_neg_log_pvalue:t,beta_col:a,stderr_beta_col:r},this.variantSpec,this.freqSpec)},isValid:function(){var e=0!==Object.keys(this.variantSpec).length,t=Object(ot["c"])(this.parserOptions.pvalue_col);return e&&t},parser:function(){if(this.isValid)try{return Object(nt["a"])(this.parserOptions)}catch(e){return function(){throw new Error("Invalid parser configuration")}}return function(){}},preview:function(){try{return this.parser(this.sample_data[0])}catch(e){return console.error(e),{error:e.toString()||"Could not parse column contents"}}}},watch:{file_reader:{immediate:!0,handler:function(){var e=this,t=function(t,a){var r;r=e.file_reader.skip?e.file_reader.skip:t.findIndex((function(e){return!Object(rt["a"])(e)})),e.sample_data=t.slice(r);var n=e.sample_data.map((function(e){return e.split("\t")}));if(r>0){e.column_titles=t[r-1].replace(/^#+/g,"").split("\t");var o=Object(rt["b"])(e.column_titles,n);o&&(Object.assign(e,o),e.variant_spec_tab=Object(ot["c"])(o.marker_col)?it:st)}else{var s=t.length?t[0].split("\t").length:0;e.column_titles=Object(p["a"])(new Array(s)).map((function(e,t){return"Column ".concat(t+1)}))}};this.file_reader.fetchHeader(t,{nLines:30,metaOnly:!1})}}},beforeCreate:function(){ut+=1,this._uid=ut,this.PAGES=ct,this.AF_SPEC=lt},mounted:function(){var e=this;document.body.addEventListener("keyup",(function(t){"Escape"===t.key&&e.$emit("close")}))},methods:{sendOptions:function(){var e=this.preview.position,t=Ie(e),a=Object(_["a"])(t,2),r=a[0],n=a[1],o={chr:this.preview.chromosome,start:r,end:n};this.$emit("ready",Object.assign({},this.parserOptions),o),this.$emit("close")}}},pt=dt,_t=(a("7b7f"),Object(ie["a"])(pt,Xe,et,!1,null,"3035afc2",null)),ft=_t.exports,mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{staticClass:"form-inline",on:{submit:function(t){return t.preventDefault(),e.selectRegion.apply(null,arguments)}}},[a("vue-bootstrap-typeahead",{attrs:{data:e.search_results,serializer:function(e){return e.term},"min-matching-chars":3,placeholder:"chr:start-end, rs, or gene"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}}),a("input",{staticClass:"btn btn-primary",attrs:{type:"submit",value:"Go to region"}})],1)},ht=[],vt=a("b047"),bt=a.n(vt),gt=a("d45f"),yt={name:"RegionPicker",components:{VueBootstrapTypeahead:gt["a"]},props:{max_range:{type:Number,default:5e5},search_url:{type:String,default:"https://portaldev.sph.umich.edu/api/v1/annotation/omnisearch/"},genome_build:{type:String,required:!0}},data:function(){return{region:null,search_results:[]}},watch:{region:bt()((function(){this.doSearch()}),500)},methods:{selectRegion:function(){var e=this,t=this.max_range;if(this.region){var a,r,n,o=this.search_results.find((function(t){return e.region===t.term}));if(o){a=o.chrom,r=o.start,n=o.end;var s=$e((r+n)/2,{region_size:t}),i=Object(_["a"])(s,2);r=i[0],n=i[1]}else try{var l=We(this.region,{region_size:t});a=l.chr,r=l.start,n=l.end}catch(c){return void this.$emit("fail",c)}this.$emit("ready",{chr:a,start:r,end:n})}else this.$emit("fail","Please specify a region")},doSearch:function(){var e=this;this.search_results=[];var t="".concat(this.search_url,"?q=").concat(encodeURIComponent(this.region),"&build=").concat(encodeURIComponent(this.genome_build));fetch(t).then((function(e){if(e.ok)return e.json();throw new Error("Server error")})).then((function(t){e.search_results=t.data.filter((function(e){return!e.error&&"region"!==e.type}))})).catch((function(){return e.$emit("fail","Could not perform the specified search")}))}}},wt=yt,xt=Object(ie["a"])(wt,mt,ht,!1,null,"1cafa324",null),Ct=xt.exports,kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-dropdown",{ref:"options_dropdown",attrs:{lazy:!0,variant:"success"},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("span",{directives:[{name:"v-b-tooltip",rawName:"v-v-b-tooltip.right",value:"This will plot data from local files. Nothing will be uploaded and these tracks will disappear when the page reloads.",expression:"'This will plot data from local files. Nothing will be uploaded and these tracks will disappear when the page reloads.'",modifiers:{right:!0}}]},[e._v("Add tabix-indexed datafile")])]},proxy:!0}])},[a("div",{staticClass:"px-3",staticStyle:{width:"300px"}},[a("form",{on:{submit:function(t){return t.preventDefault(),e.createReader.apply(null,arguments)}}},[a("b-form-group",{attrs:{label:"Data source"}},[a("b-form-radio-group",{attrs:{id:"tabix-location",options:[{text:"File",value:"file"},{text:"URL",value:"url"}],name:"tabix-location"},model:{value:e.tabix_mode,callback:function(t){e.tabix_mode=t},expression:"tabix_mode"}})],1),"file"===e.tabix_mode?[a("input",{ref:"file_picker",staticClass:"form-control",attrs:{required:"file"===e.tabix_mode,type:"file",multiple:"",accept:"application/gzip,.tbi"},on:{change:e.updateDisplayName}})]:[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.tabix_gz_url,expression:"tabix_gz_url",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{required:"url"===e.tabix_mode,type:"url",placeholder:"Specify URL..."},domProps:{value:e.tabix_gz_url},on:{blur:[e.updateDisplayName,function(t){return e.$forceUpdate()}],input:function(t){t.target.composing||(e.tabix_gz_url=t.target.value.trim())}}})],a("br"),a("b-form-group",{attrs:{label:"Type"}},[a("b-form-radio",{attrs:{name:"data-type",value:"gwas"},model:{value:e.data_type,callback:function(t){e.data_type=t},expression:"data_type"}},[e._v("\n            GWAS scatter plot ("),a("small",[a("a",{attrs:{href:"https://my.locuszoom.org/about/#prepare-data",target:"_blank"}},[e._v("suggested fields")])]),e._v(")\n          ")]),a("b-form-radio",{attrs:{name:"data-type",value:"bed"},model:{value:e.data_type,callback:function(t){e.data_type=t},expression:"data_type"}},[e._v("\n            BED 4+ intervals "),a("small",[e._v("("),a("a",{attrs:{href:"https://genome.ucsc.edu/FAQ/FAQformat.html#format1",target:"_blank"}},[e._v("file format")]),e._v(")")])]),e.allow_ld?a("b-form-radio",{attrs:{name:"data-type",value:"plink_ld"},model:{value:e.data_type,callback:function(t){e.data_type=t},expression:"data_type"}},[e._v("\n            PLINK 1.9 LD (overlay on GWAS; see "),a("a",{attrs:{target:"_blank",href:"https://statgen.github.io/localzoom#instructions"}},[e._v("instructions")]),e._v(")\n          ")]):e._e()],1),a("b-form-group",{attrs:{label:"Track Label"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.display_name,expression:"display_name",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.display_name},on:{blur:[e.updateDisplayName,function(t){return e.$forceUpdate()}],input:function(t){t.target.composing||(e.display_name=t.target.value.trim())}}})]),a("input",{staticClass:"btn btn-success",attrs:{type:"submit",value:"Add dataset"}})],2)])]),e.show_gwas_modal?a("gwas-parser-options",{attrs:{file_reader:e.tabix_reader},on:{ready:e.receiveGwasOptions,close:function(t){e.show_gwas_modal=!1}}}):e._e()],1)},St=[],Pt=(a("aef6"),a("7f7f"),a("72a6")),Ot=a("1d63"),Lt=a("a9ff"),At={name:"TabixAdder",components:{BDropdown:qe["a"],BFormGroup:tt["a"],BFormRadio:at["a"],BFormRadioGroup:Pt["a"],GwasParserOptions:ft},directives:{VBTooltip:Lt["a"]},props:{allow_ld:{type:Boolean,default:!1}},data:function(){return{tabix_mode:"file",display_name:"",data_type:z.GWAS,tabix_gz_url:"",filename:"",show_gwas_modal:!1,tabix_reader:null}},beforeCreate:function(){this.DATA_TYPES=z},methods:{reset:function(){this.display_name="",this.tabix_gz_url="",this.filename="",this.tabix_reader=null,this.show_gwas_modal=!1},updateDisplayName:function(){var e=this.display_name,t=this.tabix_mode,a=this.tabix_gz_url;if(!e){var r;if("file"===t){var n=this.$refs.file_picker.files;if(!n.length)return;var o=n[0].name;r=o.substring(0,o.lastIndexOf("."))||o}else if("url"===t){if(!a)return;try{r=new URL(a).pathname.split("/").pop().replace(/\.gz|.bgz|\.tbi/gi,"")}catch(s){return}r="/"!==r?r:a}this.display_name=r}},_fromURL:function(){var e=this.tabix_gz_url,t="".concat(e,".tbi"),a=e.split("/").pop().replace(/\.gz|.bgz|\.tbi/gi,"");return Object(Ot["b"])(e,t).then((function(e){return[e,a]}))},_fromFile:function(){for(var e,t,a=this.$refs.file_picker.files,r=0;r<a.length;r++){var n=a.item(r);n.name.endsWith(".tbi")?e=n:t=n}if(2!==a.length||!e)return Promise.reject("Must select two files: gzipped data and accompanying tabix index");var o=e.name.replace(/\.gz|\.tbi/gi,"");return Object(Ot["a"])(t,e).then((function(e){return[e,o]}))},suggestRegion:function(e,t,a){return new Promise((function(r,n){if(e===z.BED){var o=/^(browser | track |#)/,s=function(e){return!e.includes("\t")||o.test(e)},i=function(e,o){var i=!0;e.length&&!o||(i=!1);var l=t.skip?t.skip:e.findIndex((function(e){return!s(e)}));i&&-1!==l||n("Could not find data rows. Check that file is non-empty and tbi is valid");var c=e[l];try{c=a(c)}catch(v){console.error("Could not parse BED file. Error message below: \n".concat(v)),console.error(v),n("Parse error. See JS console for details.")}var u=c,d=u.chrom,p=u.chromStart,f=u.chromEnd,m=Ie((p+f)/2),h=Object(_["a"])(m,2);p=h[0],f=h[1],r({chr:d,start:p,end:f})};t.fetchHeader(i,{nLines:30,metaOnly:!1})}else r({})}))},createReader:function(e){var t=this;e.target.checkValidity();var a,r=this.tabix_mode,n=this.data_type,o=this.display_name;if("file"===r)a=this._fromFile();else{if("url"!==r)throw new Error("Cannot create reader from unknown mode");a=this._fromURL()}a.then((function(e){var a=Object(_["a"])(e,2),r=a[0],s=a[1];if(n!==z.GWAS){var i;if(n===z.BED){if(i=Object(S["b"])({normalize:!0}),!s.includes(".bed"))throw new Error("BED interval file names must include extension .bed")}else{if(n!==z.PLINK_LD)throw new Error("Unrecognized datatype");if(i=Object(S["d"])({normalize:!0}),!s.includes(".ld"))throw new Error("User PLINK LD file names must include extension .ld")}return t.suggestRegion(n,r,i).then((function(e){t.sendTrackOptions(n,r,i,s,o,e),t.reset()}))}if(s.includes(".bed")||s.includes(".ld"))throw new Error('Wrong file extension for selected data type "GWAS"');t.filename=s,t.tabix_reader=r,t.show_gwas_modal=!0})).catch((function(e){t.$emit("fail",e),t.reset()})).finally((function(){t.$refs.options_dropdown.hide()}))},receiveGwasOptions:function(e,t){var a=this.tabix_reader,r=this.filename,n=this.display_name,o=Object(S["c"])(e);this.sendTrackOptions(z.GWAS,a,o,r,n,t),this.reset()},sendTrackOptions:function(e,t,a,r,n){this.$emit.apply(this,["ready"].concat(Array.prototype.slice.call(arguments))),this.reset()}}},jt=At,zt=Object(ie["a"])(jt,kt,St,!1,null,null,null),Tt=zt.exports;function Et(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Dt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(a),!0).forEach((function(t){Object(Re["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Et(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Nt=1e6,Rt={name:"GwasToolbar",components:{BDropdown:qe["a"],GwasParserOptions:ft,BatchScroller:Qe,BatchSpec:Ue,RegionPicker:Ct,TabixAdder:Tt},props:{genome_build:{type:String,default:"GRCh37"},max_studies:{type:Number,default:6},known_tracks:{type:Array,default:function(){return[]}},batch_region_getter:{type:Function,default:null}},data:function(){return{max_region_size:Nt,message:"",message_class:"",batch_mode_active:!1,batch_mode_regions:[]}},computed:{study_count:function(){return this.known_tracks.length},i_genome_build:{get:function(){return this.genome_build},set:function(e){this.$emit("update:genome_build",e)}}},methods:{reset:function(){this.batch_mode_active=!1,this.batch_mode_regions=[],this.showMessage("","")},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text-danger";this.message=e,this.message_class=t},selectRange:function(e){this.showMessage("",""),this.$emit("select-range",e)},receiveTabixReader:function(e,t,a,r,n,o){this.showMessage("");var s=this.known_tracks.find((function(t){var a=t.data_type,n=t.filename;return n===r&&a===e}));if(s)this.showMessage("A study with this name has already been added to the plot");else{var i=this.genome_build,l=F(e,t,r,a),c=I(e,r,n),u=Dt({genome_build:i},o);this.$emit("add-tabix-track",e,r,n,l,c,u),this.reset()}},activateBatchMode:function(e){this.batch_mode_active=!0,this.batch_mode_regions=e}}},qt=Rt,Bt=Object(ie["a"])(qt,De,Ne,!1,null,null,null),Gt=Bt.exports,$t={name:"LocalZoom",components:{BCollapse:i["a"],BCard:l["a"],BTab:c["a"],BTabs:u["a"],GwasToolbar:Gt,PlotPanes:Ee},directives:{VBToggle:d["a"]},data:function(){return{base_layout:null,base_sources:null,chr:null,start:null,end:null,genome_build:"GRCh37",known_tracks:[]}},computed:{show_instructions:function(){return window.location.hash.includes("instructions")}},methods:{receiveTrackOptions:function(e,t,a,r,n,o){this.known_tracks.length?(this.$refs.plotWidget.addStudy(n,r),e===z.PLINK_LD&&this.$refs.plotWidget.$refs.assoc_plot.callPlot((function(e){V(e,a)}))):(this.updateRegion(o),this.base_sources=Z(r),this.base_layout=U(o,n),Y()),J(e),this.known_tracks.push({data_type:e,filename:t,display_name:a})},activateMetrics:function(){this.$refs.plotWidget.$refs.assoc_plot.callPlot(K)},updateRegion:function(e){var t=e.chr,a=e.start,r=e.end;t&&a&&r&&(this.chr=t,this.start=a,this.end=r)}}},It=$t,Wt=Object(ie["a"])(It,o,s,!1,null,"01023cd1",null),Ft=Wt.exports;n["init"]({dsn:"https://930af71733d64f58ab10d4184a90aee5@sentry.io/1353197",integrations:[new n["Integrations"].Vue({Vue:r["a"]})]}),new r["a"]({render:function(e){return e(Ft)}}).$mount("#app")},"7b7f":function(e,t,a){"use strict";a("32c0")},a8b7:function(e,t,a){"use strict";a("07d3")},eae3:function(e,t,a){"use strict";a("4ad3")}});
//# sourceMappingURL=app.2aa7ecc7.js.map